#include "m5stickchelper.h"

#include <M5StickC.h>
#include <pgmspace.h>

#define logoWidth 60
#define logoHeight 60

PROGMEM const unsigned char logo[] = {
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0xC0, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x07, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x1D, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x40, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x7D, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xFB, 0x03, 0x00, 0x00, 0x00, 0x00,
  0x00, 0xC0, 0xEF, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xB7, 0x1F,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0x7F, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x40, 0xFE, 0xFF, 0xE0, 0x03, 0x00, 0x00, 0x00, 0xC0, 0xF9, 0xFB,
  0xFB, 0x0F, 0x00, 0x00, 0x00, 0x80, 0xF7, 0x7F, 0xFB, 0x11, 0x00, 0x00,
  0x00, 0x80, 0x7F, 0xFF, 0xFF, 0x17, 0x00, 0x00, 0x00, 0x80, 0xFF, 0xF7,
  0xFF, 0x04, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFF, 0xFF, 0x2E, 0x00, 0x00,
  0x00, 0x00, 0xFF, 0xFF, 0xEF, 0x1D, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFF,
  0xFF, 0x02, 0x00, 0x00, 0x00, 0x00, 0xFC, 0xF7, 0xFF, 0x09, 0x00, 0x00,
  0x00, 0x00, 0xFC, 0xBF, 0xFB, 0x0D, 0x00, 0x00, 0x00, 0x00, 0xF8, 0xFF,
  0xFF, 0x03, 0x00, 0x00, 0x00, 0x00, 0xF0, 0xFF, 0xFF, 0x01, 0x00, 0x00,
  0x00, 0x00, 0xC0, 0xFF, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF,
  0x3F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0x3F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xFE, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE,
  0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0x1F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xFE, 0x1F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE,
  0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFE, 0x0F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xFC, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFC,
  0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFC, 0x03, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xFC, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8,
  0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8, 0x0F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xF0, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF0,
  0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE0, 0x0F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0xC0, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0,
  0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x0F, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x0F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
};


M5StickCHelper::M5StickCHelper()
{
    M5.begin(true, true, false);

    M5.Lcd.setRotation(1);

    paint();
}

void M5StickCHelper::updateIP(const String &ip)
{
    m_ip = ip;
    paint();
}

void M5StickCHelper::paint()
{
    M5.Lcd.drawXBitmap(0, 0, logo, logoWidth, logoHeight, TFT_WHITE);
    M5.Lcd.drawString("owlet", 108, 15, 2);
    M5.Lcd.drawString("nymea", 60, 30, 4);

    if (m_ip == "") {
        M5.Lcd.drawCentreString("Connecting...", 80, 60, 2);
    } else {
        M5.Lcd.drawCentreString("IP: " + m_ip, 80, 60, 2);
    }
}
